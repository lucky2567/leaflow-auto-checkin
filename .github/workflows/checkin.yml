name: Xserver Auto Renewal

on:
  schedule:
    # æ¯å¤©UTCæ—¶é—´01:00è¿è¡Œï¼ˆåŒ—äº¬æ—¶é—´09:00ï¼‰
    - cron: '0 1 * * *' 
  # å…è®¸æ‰‹åŠ¨è§¦å‘
  workflow_dispatch: 

jobs:
  checkin:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        # å‡è®¾ requirements.txt ä¸­åŒ…å«äº† selenium, requests, etc.
        pip install -r requirements.txt
        
    - name: Install Chrome
      run: |
        sudo apt-get update
        # ç¡®ä¿å®‰è£…äº† Google Chrome ç¨³å®šç‰ˆ
        sudo apt-get install -y google-chrome-stable
        
    - name: Run Xserver Renewal Script ğŸ› ï¸
      # =========================================================
      # ğŸ’¥ å…³é”®ä¿®æ”¹ï¼šæ›´æ¢ä¸º Xserver è„šæœ¬æ‰€éœ€çš„ç¯å¢ƒå˜é‡
      # =========================================================
      env:
        # Xserver å•è´¦å·ç™»å½•å‡­è¯ (å¿…å¡«)
        XSERVER_USERNAME: ${{ secrets.XSERVER_USERNAME }}
        XSERVER_PASSWORD: ${{ secrets.XSERVER_PASSWORD }}
        
        # Xserver å¤šè´¦å·åˆ—è¡¨ (å¯é€‰, ä¼˜å…ˆçº§ä½äºå•è´¦å·)
        # å¦‚æœæ‚¨ä½¿ç”¨ XSERVER_ACCOUNTSï¼Œåˆ™ä¸éœ€è¦è®¾ç½® USERNAME/PASSWORD
        XSERVER_ACCOUNTS: ${{ secrets.XSERVER_ACCOUNTS }}
        
        # Telegram é€šçŸ¥è®¾ç½® (å¯é€‰)
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        
        # æ ‡å¿—å½“å‰è¿è¡Œç¯å¢ƒä¸º GitHub Actions (ç”±è„šæœ¬è¯»å–)
        GITHUB_ACTIONS: true 
        
      run: |
        # ğŸ’¥ å…³é”®ä¿®æ”¹ï¼šè¿è¡Œ XserverRenewal.py è„šæœ¬æ–‡ä»¶
        python leaflow_checkin.py
